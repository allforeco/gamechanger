{% extends "base_generic.html" %}

{% block title %}
    <title>Contacts Overview - Gamechanger Action Tracker</title>
{% endblock %}

{% block content %}
{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
<div>
  <h2></h2>
  <ul>
    {% for country, regioncontacts in contacts_region_dict.items %}
    <div id="{{country.0}}" class="regionbrick">
      <span>
        <h2 style="float: left;">
          {% if country.1 > -1 %}
          <a href="{% url 'action:geo_view' country.1 %}">{{country.0}}</a>
          {% else %}
          {{country.0}}
          {% endif %}
        </h2>
        <input id="collapse_{{country.0}}" style="float: right; padding: 1em;" value="-" type="button" onclick="toggleTable('{{country.0}}')"/>
      </span>
      <table id="table_{{country}}" style="width: 100%; display: block;">
        <thead style="width: 100%;">
          <tr style="width: 100%;">
            <th class="td_display_region">Region</th>
            <th>Contact</th>
            </tr>
          
        </thead>
        <tbody style="width: 100%;">
          {% for region, contacts in regioncontacts.items %}
            <tr style="width: 100%;">
              <td>
                {% if region.1 > -1 %}
                <a href="{% url 'action:geo_view' region.1 %}">{{region.0}}</a>
                {% else %}
                  {{region.0}}
                {% endif %}
                
              </td>
              <td class="td_display_contact">
                <ul>
                {% for contact in contacts %}
                <li class="contact_link" style="list-style-type: disc; padding-left: 0%;margin-right: 1em;">
                  {% if contact.organization.id > -1 %}
                  <a href="{% url 'action:organization_view' contact.organization.id %}">{{contact.organization}}</a>:
                  {% elif contact.organizationTitle %}
                  {{contact.organizationTitle}}:
                  {% endif %}
                  <a href="{{contact.url}}" target="_blank" title="{{contact.info}}"><!--{{contact.contacttype}}--><img src="{{contact.icon}}" alt="{{contact.contacttype}}"/></a>
                </li>
                {% endfor %}
                </ul>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endfor %}
  </ul>
</div>
<script>
  function toggleTable(region){
    table = document.getElementById(region).getElementsByTagName('table')[0];
    button = document.getElementById('collapse_'+region);
    console.log(table);
    if (table.style.display != 'none'){
      table.style.display = 'none';
      button.value='+';
    }else{
      table.style.display = 'block'
      button.value='-';
    }
  }
</script>

<style>
  .regionbrick{
    margin-bottom: 2em; 
    background-color: whitesmoke; 
    border-radius: 12px;
    display: block;
    
    height: fit-content;
    min-height: 3em;
    /*width: fit-content;*/
    margin: 1em auto;
    width: 66%;
    padding: 1em; 
    padding-top: 0.01em;
  }

  .regionbrick table{
    width: 100%;
    overflow: hidden;
    display: block;
  }

  .regionbrick td{
    height: 2em;
    overflow: hidden;
  }

  .td_display_region{
    /*width: 10%;*/
    width: 1%;
    text-align: center;
    height: 3em;
  }

  .td_display_org{
    /*width: 30%;*/
    width: 30%;
  }
  .td_display_contact{
    /*width: 60%;*/
    width: 100%;
  }

  .contact_link{
    float: left;
    padding: 1em;
  }

  .external_link_icon{
    height: 1em;
    position: relative;
    top:-10px;
  }
</style>

{% endblock %}